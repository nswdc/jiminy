<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Frames Stacking &mdash; jiminy 1.7.16 documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Utils" href="../utils/index.html" />
    <link rel="prev" title="Wrappers" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            jiminy
              <img src="../../../../_static/jiminy_logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                1.7.16
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">README</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../README.html">Key features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../README.html#gym-jiminy">Gym Jiminy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../README.html#demo">Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../README.html#getting-started">Getting started</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">INSTALLATION</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../INSTALL.html">Easy-install on Ubuntu 18+</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../INSTALL.html#building-from-source">Building from source</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TUTORIALS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../tutorial.html">An introduction to Jiminy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API DOC</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../jiminy/index.html">Jiminy C++ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../jiminy_py/index.html">Jiminy Python API</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Gym Jiminy API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bases/index.html">Bases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../envs/index.html">Envs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pipeline.html">Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../controllers/index.html">Controllers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Wrappers</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Frames Stacking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack"><code class="docutils literal notranslate"><span class="pre">PartialFrameStack</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv"><code class="docutils literal notranslate"><span class="pre">StackedJiminyEnv</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../utils/index.html">Utils</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Technical Specifications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../spec/src/tlmc_format_specification.html">HDF5 telemetry log format (TLMC)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../spec/pdf/index.html">Downloadable PDF</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">jiminy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Gym Jiminy API</a></li>
          <li class="breadcrumb-item"><a href="index.html">Wrappers</a></li>
      <li class="breadcrumb-item active">Frames Stacking</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/api/gym_jiminy/common/wrappers/frame_stack.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-gym_jiminy.common.wrappers.frame_stack">
<span id="frames-stacking"></span><h1>Frames Stacking<a class="headerlink" href="#module-gym_jiminy.common.wrappers.frame_stack" title="Permalink to this heading">¶</a></h1>
<p>TODO: Write documentation.</p>
<dl class="py class">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gym_jiminy.common.wrappers.frame_stack.</span></span><span class="sig-name descname"><span class="pre">PartialFrameStack</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_stack</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nested_filter_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#PartialFrameStack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Wrapper</span></code>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">ObsT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ActT</span></code>]</p>
<p>Observation wrapper that partially stacks observations in a rolling
manner.</p>
<p>This wrapper combines and extends OpenAI Gym wrappers <cite>FrameStack</cite> and
<cite>FilterObservation</cite> to support nested filter keys.</p>
<p>It adds one extra dimension to all the leaves of the original observation
spaces that must be stacked. If so, the first dimension corresponds to the
individual timesteps (from oldest [0] to latest [-1]).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The observation space must be <cite>gym.spaces.Dict</cite>, while, ultimately,
stacked leaf fields must be <cite>gym.spaces.Box</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – Environment to wrap.</p></li>
<li><p><strong>nested_filter_keys</strong> – List of nested observation fields to stack.
Those fields does not have to be leaves. If
not, then every leaves fields from this root
will be stacked.</p></li>
<li><p><strong>num_stack</strong> – Number of observation frames to partially stack.</p></li>
<li><p><strong>kwargs</strong> – Extra keyword arguments to allow automatic pipeline
wrapper generation.</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">spaces.Space</span><span class="p"><span class="pre">[</span></span><span class="pre">ObsType</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">spaces.Space</span><span class="p"><span class="pre">[</span></span><span class="pre">WrapperObsType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Env</span></code> <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.observation_space" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.observation_space"><code class="xref py py-attr docutils literal notranslate"><span class="pre">observation_space</span></code></a> unless overwritten then the wrapper <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.observation_space" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.observation_space"><code class="xref py py-attr docutils literal notranslate"><span class="pre">observation_space</span></code></a> is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack._setup">
<span class="sig-name descname"><span class="pre">_setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#PartialFrameStack._setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack._setup" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Write documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.refresh_observation">
<span class="sig-name descname"><span class="pre">refresh_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measurement</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#PartialFrameStack.refresh_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.refresh_observation" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO: Write documentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>measurement</strong> (<em>ObsT</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#PartialFrameStack.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.step" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">step()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>ActT</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<em>ObsT</em>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.SupportsFloat" title="(in Python v3.11)"><em>SupportsFloat</em></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#PartialFrameStack.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reset" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reset"><code class="xref py py-meth docutils literal notranslate"><span class="pre">reset()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<em>ObsT</em>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack._is_protocol">
<span class="sig-name descname"><span class="pre">_is_protocol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack._is_protocol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack._np_random">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">_np_random</span></span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack._np_random" title="Permalink to this definition">¶</a></dt>
<dd><p>This code will never be run due to __getattr__ being called prior this.</p>
<p>It seems that &#64;property overwrites the variable (<cite>_np_random</cite>) meaning that __getattr__ gets called with the missing variable.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">spaces.Space</span><span class="p"><span class="pre">[</span></span><span class="pre">ActType</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">spaces.Space</span><span class="p"><span class="pre">[</span></span><span class="pre">WrapperActType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Env</span></code> <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.action_space" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.action_space"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action_space</span></code></a> unless overwritten then the wrapper <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.action_space" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.action_space"><code class="xref py py-attr docutils literal notranslate"><span class="pre">action_space</span></code></a> is used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.class_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">class_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.class_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the class name of the wrapper.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the wrapper and <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.np_random">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">np_random</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Generator</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.np_random" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Env</span></code> <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.np_random" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.np_random"><code class="xref py py-attr docutils literal notranslate"><span class="pre">np_random</span></code></a> attribute.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.render" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.render"><code class="xref py py-meth docutils literal notranslate"><span class="pre">render()</span></code></a> of the <code class="xref py py-attr docutils literal notranslate"><span class="pre">env</span></code> that can be overwritten to change the returned data.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>RenderFrame | <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.11)">list</a>[RenderFrame] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.render_mode">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">render_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.render_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Env</span></code> <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.render_mode" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.render_mode"><code class="xref py py-attr docutils literal notranslate"><span class="pre">render_mode</span></code></a>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reward_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_range</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><span class="pre">SupportsFloat</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">SupportsFloat</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reward_range" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Env</span></code> <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reward_range" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reward_range"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reward_range</span></code></a> unless overwritten then the wrapper <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reward_range" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.reward_range"><code class="xref py py-attr docutils literal notranslate"><span class="pre">reward_range</span></code></a> is used.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EnvSpec</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Env</span></code> <a class="reference internal" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.spec" title="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.spec"><code class="xref py py-attr docutils literal notranslate"><span class="pre">spec</span></code></a> attribute with the <cite>WrapperSpec</cite> if the wrapper inherits from <cite>EzPickle</cite>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.unwrapped">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unwrapped</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Env</span><span class="p"><span class="pre">[</span></span><span class="pre">ObsType</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ActType</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.unwrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the base environment of the wrapper.</p>
<p>This will be the bare <code class="xref py py-class docutils literal notranslate"><span class="pre">gymnasium.Env</span></code> environment, underneath all layers of wrappers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.wrapper_spec">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wrapper_spec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.PartialFrameStack.wrapper_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a <cite>WrapperSpec</cite> for the wrappers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<em>Any</em>) – </p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>WrapperSpec</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">gym_jiminy.common.wrappers.frame_stack.</span></span><span class="sig-name descname"><span class="pre">StackedJiminyEnv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_frames_ratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#StackedJiminyEnv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="../bases/pipeline_bases.html#gym_jiminy.common.bases.pipeline_bases.BasePipelineWrapper" title="gym_jiminy.common.bases.pipeline_bases.BasePipelineWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePipelineWrapper</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">ObsT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ActT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ObsT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ActT</span></code>], <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">ObsT</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">ActT</span></code>]</p>
<p>TODO: Write documentation.</p>
<p>TODO: Write documentation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.observation">
<span class="sig-name descname"><span class="pre">observation</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ObsT</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.observation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._initialize_action_space">
<span class="sig-name descname"><span class="pre">_initialize_action_space</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#StackedJiminyEnv._initialize_action_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._initialize_action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the action space.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._initialize_observation_space">
<span class="sig-name descname"><span class="pre">_initialize_observation_space</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#StackedJiminyEnv._initialize_observation_space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._initialize_observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the observation space.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._setup">
<span class="sig-name descname"><span class="pre">_setup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#StackedJiminyEnv._setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._setup" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the wrapper.</p>
<p>By default, it only resets some internal buffers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method must be called once, after the environment has been
reset. This is done automatically when calling <cite>reset</cite> method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.refresh_observation">
<span class="sig-name descname"><span class="pre">refresh_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">measurement</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#StackedJiminyEnv.refresh_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.refresh_observation" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute observed features based on the current simulation state and
lower-level measure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>measurement</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.11)"><em>Mapping</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><em>StructNested</em><em>[</em><em>ValueT</em><em>]</em><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)"><em>Iterable</em></a><em>[</em><em>StructNested</em><em>[</em><em>ValueT</em><em>]</em><em>] </em><em>| </em><em>ndarray</em>) – Low-level measure from the environment to process
to get higher-level observation.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._abc_impl">
<span class="sig-name descname"><span class="pre">_abc_impl</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">&lt;_abc_data</span> <span class="pre">object&gt;</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._abc_impl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._controller_handle">
<span class="sig-name descname"><span class="pre">_controller_handle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensors_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">command</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._controller_handle" title="Permalink to this definition">¶</a></dt>
<dd><p>Thin wrapper around user-specified <cite>refresh_observation</cite> and
<cite>compute_command</cite> methods.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is not supposed to be called manually nor overloaded.
It will be used by the base environment to instantiate a
<cite>jiminy.ControllerFunctor</cite> that will be responsible for refreshing
observations and compute commands of all the way through a given
pipeline in the correct order of the blocks to finally sends
command motor torques directly to the robot.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Current simulation time.</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Current actual configuration of the robot. Note that it is
not the one of the theoretical model even if
‘use_theoretical_model’ is enabled for the backend Python
<cite>Simulator</cite>.</p></li>
<li><p><strong>v</strong> (<em>ndarray</em>) – Current actual velocity vector.</p></li>
<li><p><strong>sensors_data</strong> (<a class="reference internal" href="../../../jiminy_py/core/robot.html#jiminy_py.core.sensorsData" title="jiminy_py.core.sensorsData"><em>sensorsData</em></a>) – Current sensor data.</p></li>
<li><p><strong>command</strong> (<em>ndarray</em>) – Output argument corresponding to motors torques to
apply on the robot. It must be updated by reference
using <cite>[:]</cite> or <cite>np.copyto</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Motors torques to apply on the robot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._is_protocol">
<span class="sig-name descname"><span class="pre">_is_protocol</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._is_protocol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._np_random">
<span class="sig-name descname"><span class="pre">_np_random</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">np.random.Generator</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._np_random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._observer_handle">
<span class="sig-name descname"><span class="pre">_observer_handle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sensors_data</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv._observer_handle" title="Permalink to this definition">¶</a></dt>
<dd><p>Thin wrapper around user-specified <cite>refresh_observation</cite> method.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is not supposed to be called manually nor overloaded.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – Current simulation time.</p></li>
<li><p><strong>q</strong> (<em>ndarray</em>) – Current actual configuration of the robot. Note that it is
not the one of the theoretical model even if
‘use_theoretical_model’ is enabled for the backend Python
<cite>Simulator</cite>.</p></li>
<li><p><strong>v</strong> (<em>ndarray</em>) – Current actual velocity vector.</p></li>
<li><p><strong>sensors_data</strong> (<a class="reference internal" href="../../../jiminy_py/core/robot.html#jiminy_py.core.sensorsData" title="jiminy_py.core.sensorsData"><em>sensorsData</em></a>) – Current sensor data.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the wrapper and its base environment.</p>
<p>By default, it does nothing but forwarding the request to the base
environment. This behavior can be overwritten by the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.compute_command">
<span class="sig-name descname"><span class="pre">compute_command</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../_modules/gym_jiminy/common/wrappers/frame_stack.html#StackedJiminyEnv.compute_command"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.compute_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the motors efforts to apply on the robot.</p>
<p>It simply forwards the command computed by the wrapped environment
without any processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>ActT</em>) – High-level target to achieve by means of the command.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><em>ndarray</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.compute_reward">
<span class="sig-name descname"><span class="pre">compute_reward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">done</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncated</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.compute_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the reward related to a specific control block.</p>
<p>For the corresponding MDP to be stationary, the computation of the
reward is supposed to involve only the transition from previous to
current state of the simulation (possibly comprising multiple agents)
under the ongoing action.</p>
<p>By default, it returns 0.0 no matter what. It is up to the user to
provide a dedicated reward function whenever appropriate.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Only returning an aggregated scalar reward is supported. Yet, it is
possible to update ‘info’ by reference if one wants for keeping
track of individual reward components or any kind of extra info
that may be helpful for monitoring or debugging purposes.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>done</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Whether the episode has reached one of terminal states of
the MDP at the current step. This flag can be used to
compute a specific terminal reward.</p></li>
<li><p><strong>truncated</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – Whether a truncation condition outside the scope of
the MDP has been satisfied at the current step. This
flag can be used to adapt the reward.</p></li>
<li><p><strong>info</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a><em>]</em>) – Dictionary of extra information for monitoring.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Aggregated reward for the current step.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.control_dt">
<span class="sig-name descname"><span class="pre">control_dt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.control_dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.eval">
<span class="sig-name descname"><span class="pre">eval</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the environment in evaluation mode.</p>
<p>This only has an effect on certain environments. It can be used for
instance to enable clipping or filtering of the action at evaluation
time specifically. See documentations of a given environment for
details about their behaviors in training and evaluation modes.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.is_training">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_training</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.is_training" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether the environment is in ‘train’ or ‘eval’ mode.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.np_random">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">np_random</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Generator</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.np_random" title="Permalink to this definition">¶</a></dt>
<dd><p>Random number generator of the base environment.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.observe_dt">
<span class="sig-name descname"><span class="pre">observe_dt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">-1</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.observe_dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the unified environment.</p>
<p>By default, it does nothing but forwarding the request to the base
environment. This behavior can be overwritten by the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>RenderFrame</em> | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.11)"><em>List</em></a>[<em>RenderFrame</em>] | None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.render_mode">
<span class="sig-name descname"><span class="pre">render_mode</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.render_mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the unified environment.</p>
<p>In practice, it resets the environment and initializes the generic
pipeline internal buffers through the use of ‘controller_hook’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>controller_hook</strong> – Used internally for chaining multiple
<cite>BasePipelineWrapper</cite>. It is not meant to be
defined manually.
Optional: None by default.</p></li>
<li><p><strong>kwargs</strong> – Extra keyword arguments to comply with OpenAI Gym API.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em> | </em><em>None</em>) – </p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><em>Dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a><em>] </em><em>| </em><em>None</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.11)"><em>Mapping</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>, StructNested[ValueT]] | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)"><em>Iterable</em></a>[StructNested[ValueT]] | <em>ndarray</em>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.reward_range">
<span class="sig-name descname"><span class="pre">reward_range</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">(-inf,</span> <span class="pre">inf)</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.reward_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.spec">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">spec</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">EnvSpec</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><span class="pre">None</span></a></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Random number generator of the base environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a simulation step for a given action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>action</strong> (<em>ActT</em>) – Next action to perform. <cite>None</cite> to not update it.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Next observation, reward, status of the episode (done or
not), and a dictionary of extra information.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.11)"><em>Tuple</em></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Mapping" title="(in Python v3.11)"><em>Mapping</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>, StructNested[ValueT]] | <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)"><em>Iterable</em></a>[StructNested[ValueT]] | <em>ndarray</em>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.SupportsFloat" title="(in Python v3.11)"><em>SupportsFloat</em></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.11)"><em>Dict</em></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><em>Any</em></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.step_dt">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">step_dt</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.step_dt" title="Permalink to this definition">¶</a></dt>
<dd><p>Get timestep of a single ‘step’.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the environment in training mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.unwrapped">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">unwrapped</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../bases/generic_bases.html#gym_jiminy.common.bases.generic_bases.JiminyEnvInterface" title="gym_jiminy.common.bases.generic_bases.JiminyEnvInterface"><span class="pre">JiminyEnvInterface</span></a></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.unwrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Base environment of the pipeline.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.env">
<span class="sig-name descname"><span class="pre">env</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../bases/generic_bases.html#gym_jiminy.common.bases.generic_bases.JiminyEnvInterface" title="gym_jiminy.common.bases.generic_bases.JiminyEnvInterface"><span class="pre">JiminyEnvInterface</span></a><span class="p"><span class="pre">[</span></span><span class="pre">BaseObsT</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">BaseActT</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.env" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.simulator">
<span class="sig-name descname"><span class="pre">simulator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="../../../jiminy_py/simulator.html#jiminy_py.simulator.Simulator" title="jiminy_py.simulator.Simulator"><span class="pre">Simulator</span></a></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.simulator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.robot">
<span class="sig-name descname"><span class="pre">robot</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jiminy.Robot</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.robot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.stepper_state">
<span class="sig-name descname"><span class="pre">stepper_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jiminy.StepperState</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.stepper_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.system_state">
<span class="sig-name descname"><span class="pre">system_state</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">jiminy.SystemState</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.system_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.sensors_data">
<span class="sig-name descname"><span class="pre">sensors_data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">SensorsDataType</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.sensors_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.is_simulation_running">
<span class="sig-name descname"><span class="pre">is_simulation_running</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">npt.NDArray</span><span class="p"><span class="pre">[</span></span><span class="pre">np.bool_</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.is_simulation_running" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.action">
<span class="sig-name descname"><span class="pre">action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">ActT</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.action" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.observation_space">
<span class="sig-name descname"><span class="pre">observation_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">gym.Space</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.observation_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.action_space">
<span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">gym.Space</span></em><a class="headerlink" href="#gym_jiminy.common.wrappers.frame_stack.StackedJiminyEnv.action_space" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Wrappers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../utils/index.html" class="btn btn-neutral float-right" title="Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, Alexis Duburcq - MIT licence.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>